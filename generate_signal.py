import pandas as pd

# ุจูุงูุงุช ุชุฌุฑูุจูุฉ (ูููู ูุฑุจุทูุง ุจุจูุงูุงุช ุญููููุฉ ูุงุญูุงู)
stocks = [
    {"ุฑูุฒ": "KLTO", "ุงูุณุนุฑ": 1.62, "RSI": 32, "MACD": -0.01, "ูุชูุงูู": True},
    {"ุฑูุฒ": "ADCT", "ุงูุณุนุฑ": 2.35, "RSI": 45, "MACD": 0.05, "ูุชูุงูู": True},
    {"ุฑูุฒ": "PHUN", "ุงูุณุนุฑ": 1.2, "RSI": 25, "MACD": -0.04, "ูุชูุงูู": True},
    {"ุฑูุฒ": "SOUN", "ุงูุณุนุฑ": 4.8, "RSI": 65, "MACD": 0.12, "ูุชูุงูู": False},
    {"ุฑูุฒ": "VTVT", "ุงูุณุนุฑ": 0.97, "RSI": 28, "MACD": -0.02, "ูุชูุงูู": True},
    {"ุฑูุฒ": "CEI", "ุงูุณุนุฑ": 0.55, "RSI": 72, "MACD": 0.15, "ูุชูุงูู": False},
]

df = pd.DataFrame(stocks)

# ููุชุฑุฉ ุงูุฃุณูู ุญุณุจ ูุนุงููุฑ ูููุฉ ูุดุฑุนูุฉ
filtered = df[
    (df["ุงูุณุนุฑ"] < 5) &
    (df["RSI"] < 35) &
    (df["MACD"] < 0) &
    (df["ูุชูุงูู"] == True)
]

# ุงุฎุชูุงุฑ ุฃูุถู ุณูู ุจูุงุกู ุนูู ูุฒู: RSI ููุฎูุถ + ุณุนุฑ ุฃุนูู
def score(row):
    return (35 - row["RSI"]) + (row["ุงูุณุนุฑ"])
filtered["ุงูุชูููู"] = filtered.apply(score, axis=1)
best = filtered.sort_values(by="ุงูุชูููู", ascending=False).iloc[0]

# ุชุฌููุฒ ุงูุชูุตูุฉ
entry = round(best["ุงูุณุนุฑ"], 2)
stop = round(entry * 0.95, 2)
target1 = round(entry * 1.10, 2)
target2 = round(entry * 1.20, 2)

message = f"""
๐ ุชูุตูุฉ ุฐููุฉ ุงูููู ูู ุดุงุชุดุช

๐ ุงูุณูู: {best['ุฑูุฒ']}
โข ุงูุณุนุฑ ุงูุญุงูู: {entry}
โข ููู ุงูุฎุณุงุฑุฉ: {stop}
โข ุงููุฏู ุงูุฃูู: {target1}
โข ุงููุฏู ุงูุซุงูู: {target2}
โข RSI: {best['RSI']}
โข MACD: {best['MACD']}
โข ุงูุดุฑุนูุฉ: โ ูุชูุงูู ูุน ุงูุดุฑูุนุฉ

๐ก ุชู ุงุฎุชูุงุฑ ุงูุณูู ุจูุงุก ุนูู ุชุญููู ููู ุชููุงุฆู.
"""

# ุญูุธ ุงูุชูุตูุฉ ููุฑุณููุง ุงูุณูุฑุจุช ุงูุซุงูู
with open("signal.txt", "w") as f:
    f.write(message)
